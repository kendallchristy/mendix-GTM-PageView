import { useEffect, createElement } from 'react';

var warn$1 = {};

Object.defineProperty(warn$1, "__esModule", {
  value: true
});

var warn = function warn(s) {
  console.warn('[react-gtm]', s);
};

warn$1.default = warn;

var _warn = warn$1;

var _warn2 = _interopRequireDefault$2(_warn);

function _interopRequireDefault$2(obj) {
  return obj && obj.__esModule ? obj : {
    default: obj
  };
} // https://developers.google.com/tag-manager/quickstart


var Snippets = {
  tags: function tags(_ref) {
    var id = _ref.id,
        events = _ref.events,
        dataLayer = _ref.dataLayer,
        dataLayerName = _ref.dataLayerName,
        preview = _ref.preview,
        auth = _ref.auth;
    var gtm_auth = '&gtm_auth=' + auth;
    var gtm_preview = '&gtm_preview=' + preview;
    if (!id) (0, _warn2.default)('GTM Id is required');
    var iframe = '\n      <iframe src="https://www.googletagmanager.com/ns.html?id=' + id + gtm_auth + gtm_preview + '&gtm_cookies_win=x"\n        height="0" width="0" style="display:none;visibility:hidden" id="tag-manager"></iframe>';
    var script = '\n      (function(w,d,s,l,i){w[l]=w[l]||[];\n        w[l].push({\'gtm.start\': new Date().getTime(),event:\'gtm.js\', ' + JSON.stringify(events).slice(1, -1) + '});\n        var f=d.getElementsByTagName(s)[0],j=d.createElement(s),dl=l!=\'dataLayer\'?\'&l=\'+l:\'\';\n        j.async=true;j.src=\'https://www.googletagmanager.com/gtm.js?id=\'+i+dl+\'' + gtm_auth + gtm_preview + '&gtm_cookies_win=x\';\n        f.parentNode.insertBefore(j,f);\n      })(window,document,\'script\',\'' + dataLayerName + '\',\'' + id + '\');';
    var dataLayerVar = this.dataLayer(dataLayer, dataLayerName);
    return {
      iframe: iframe,
      script: script,
      dataLayerVar: dataLayerVar
    };
  },
  dataLayer: function dataLayer(_dataLayer, dataLayerName) {
    return '\n      window.' + dataLayerName + ' = window.' + dataLayerName + ' || [];\n      window.' + dataLayerName + '.push(' + JSON.stringify(_dataLayer) + ')';
  }
};
var Snippets_1 = Snippets;

var _Snippets = Snippets_1;

var _Snippets2 = _interopRequireDefault$1(_Snippets);

function _interopRequireDefault$1(obj) {
  return obj && obj.__esModule ? obj : {
    default: obj
  };
}

var TagManager = {
  dataScript: function dataScript(dataLayer) {
    var script = document.createElement('script');
    script.innerHTML = dataLayer;
    return script;
  },
  gtm: function gtm(args) {
    var snippets = _Snippets2.default.tags(args);

    var noScript = function noScript() {
      var noscript = document.createElement('noscript');
      noscript.innerHTML = snippets.iframe;
      return noscript;
    };

    var script = function script() {
      var script = document.createElement('script');
      script.innerHTML = snippets.script;
      return script;
    };

    var dataScript = this.dataScript(snippets.dataLayerVar);
    return {
      noScript: noScript,
      script: script,
      dataScript: dataScript
    };
  },
  initialize: function initialize(_ref) {
    var gtmId = _ref.gtmId,
        _ref$events = _ref.events,
        events = _ref$events === undefined ? {} : _ref$events,
        dataLayer = _ref.dataLayer,
        _ref$dataLayerName = _ref.dataLayerName,
        dataLayerName = _ref$dataLayerName === undefined ? 'dataLayer' : _ref$dataLayerName,
        _ref$auth = _ref.auth,
        auth = _ref$auth === undefined ? '' : _ref$auth,
        _ref$preview = _ref.preview,
        preview = _ref$preview === undefined ? '' : _ref$preview;
    var gtm = this.gtm({
      id: gtmId,
      events: events,
      dataLayer: dataLayer || undefined,
      dataLayerName: dataLayerName,
      auth: auth,
      preview: preview
    });
    if (dataLayer) document.head.appendChild(gtm.dataScript);
    document.head.insertBefore(gtm.script(), document.head.childNodes[0]);
    document.body.insertBefore(gtm.noScript(), document.body.childNodes[0]);
  },
  dataLayer: function dataLayer(_ref2) {
    var _dataLayer = _ref2.dataLayer,
        _ref2$dataLayerName = _ref2.dataLayerName,
        dataLayerName = _ref2$dataLayerName === undefined ? 'dataLayer' : _ref2$dataLayerName;
    if (window[dataLayerName]) return window[dataLayerName].push(_dataLayer);

    var snippets = _Snippets2.default.dataLayer(_dataLayer, dataLayerName);

    var dataScript = this.dataScript(snippets);
    document.head.insertBefore(dataScript, document.head.childNodes[0]);
  }
};
var TagManager_1 = TagManager;

var _TagManager = TagManager_1;

var _TagManager2 = _interopRequireDefault(_TagManager);

function _interopRequireDefault(obj) {
  return obj && obj.__esModule ? obj : {
    default: obj
  };
}

var dist = _TagManager2.default;

const InitializeGTM = props => {
  useEffect(() => {
    if (!mx.ga4Connected) {
      // flag to prevent onNavigation from sending multiple page views after things like after widget load, after show page, etc.
      // dataUnavailable check here because the render function will take care of calling it multiple times
      let dataUnavailable = false;

      for (let object of props.additionalProps) {
        if (object.propDataSource.status !== 'available') {
          dataUnavailable = true;
        }
      }

      if (!dataUnavailable) {
        const origOnNavigation = mx.ui.getContentForm().onNavigation; // save what the original onNavigation function did

        mx.ui.getContentForm().onNavigation = () => {
          // Custom Actions
          if (props.sendCustomProps === false) {
            const tagManagerArgsInitialize = {
              gtmId: props.measurementID
            };
            dist.initialize(tagManagerArgsInitialize);
          } else {
            let dataLayerStructure = function (props) {
              var dataLayer = '{"event":"' + props.pageViewEventName + '",'; // initialize the dataLayer variable

              if (props.sendPageTitle) {
                // send page title
                dataLayer += '"Page Name":"' + mx.ui.getContentForm().title + '",';
              }

              if (props.sendModuleLocation) {
                // send module location
                var modulePath = mx.ui.getContentForm().path;

                var moduleLocation = function (modulePath) {
                  var pageExtension = ".page.xml";
                  var path = modulePath.substr(0, modulePath.length - pageExtension.length);
                  return path;
                }(modulePath);

                dataLayer += '"Module Location":"' + moduleLocation + '",';
              }

              if (props.sendPageURL) {
                // send page URL
                if (mx.ui.getContentForm().url !== null) {
                  var pageURL = window.location.origin + mx.ui.getContentForm().url;
                } else {
                  var pageURL = window.location.origin;
                }

                var trimmedURL = function (fullURL) {
                  var lastCharIndex = fullURL.lastIndexOf("/");
                  var endString = fullURL.substring(lastCharIndex + 1, fullURL.length);

                  if (isNaN(endString)) {
                    return fullURL; // the end of the string isn't a number, return the whole thing
                  } else {
                    return fullPath.substr(0, lastCharIndex); // the end of the string is a number, trim it
                  }
                }(pageURL);

                dataLayer += '"Page URL":"' + trimmedURL + '",';
              }

              if (props.sendSessionID) {
                // send session ID
                dataLayer += '"Session ID":"' + mx.session.getSessionObjectId() + '",';
              }

              if (props.sendAdditionalProps) {
                // send additional properties
                let expressionResult = '';

                for (let line of props.additionalProps) {
                  for (let object of line.propDataSource.items) {
                    // object is an item in the list that is returned from the data source
                    expressionResult += line.propValue.get(object).value + ', ';
                  }

                  expressionResult = expressionResult.replace(/,\s*$/, "");
                  dataLayer += '"' + line.propName + '":"' + expressionResult + '",';
                  expressionResult = '';
                }
              }

              dataLayer = dataLayer.replace(/,\s*$/, ""); // remove the last comma from the dataLayer variable

              dataLayer += "}";
              return JSON.parse(dataLayer);
            };

            let dataLayer = dataLayerStructure(props);
            const tagManagerArgs = {
              gtmId: props.measurementID,
              dataLayer
            };
            dist.initialize(tagManagerArgs);
          }

          mx.ga4Connected = true; // We have sent the page hit, now toggle the switch off to avoid sending duplicates
          // Original Actions

          origOnNavigation();
          return () => {
          };
        };
      }
    }
  }); // no dependency array -> trigger on every load

  return null;
};

function GoogleTagManager({
  measurementID,
  sendCustomProps,
  pageViewEventName,
  sendPageTitle,
  sendModuleLocation,
  sendPageURL,
  sendSessionID,
  sendAdditionalProps,
  additionalProps
}) {
  return createElement(InitializeGTM, {
    measurementID: measurementID,
    sendCustomProps: sendCustomProps,
    pageViewEventName: pageViewEventName,
    sendPageTitle: sendPageTitle,
    sendModuleLocation: sendModuleLocation,
    sendPageURL: sendPageURL,
    sendSessionID: sendSessionID,
    sendAdditionalProps: sendAdditionalProps,
    additionalProps: additionalProps
  });
}

export { GoogleTagManager };
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiR29vZ2xlVGFnTWFuYWdlci5tanMiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uLy4uL25vZGVfbW9kdWxlcy9yZWFjdC1ndG0tbW9kdWxlL2Rpc3QvdXRpbHMvd2Fybi5qcyIsIi4uLy4uLy4uLy4uLy4uL25vZGVfbW9kdWxlcy9yZWFjdC1ndG0tbW9kdWxlL2Rpc3QvU25pcHBldHMuanMiLCIuLi8uLi8uLi8uLi8uLi9ub2RlX21vZHVsZXMvcmVhY3QtZ3RtLW1vZHVsZS9kaXN0L1RhZ01hbmFnZXIuanMiLCIuLi8uLi8uLi8uLi8uLi9ub2RlX21vZHVsZXMvcmVhY3QtZ3RtLW1vZHVsZS9kaXN0L2luZGV4LmpzIiwiLi4vLi4vLi4vLi4vLi4vc3JjL2NvbXBvbmVudHMvSW5pdGlhbGl6ZUdUTS5qc3giLCIuLi8uLi8uLi8uLi8uLi9zcmMvR29vZ2xlVGFnTWFuYWdlci5qc3giXSwic291cmNlc0NvbnRlbnQiOlsiJ3VzZSBzdHJpY3QnO1xuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgdmFsdWU6IHRydWVcbn0pO1xudmFyIHdhcm4gPSBmdW5jdGlvbiB3YXJuKHMpIHtcbiAgY29uc29sZS53YXJuKCdbcmVhY3QtZ3RtXScsIHMpO1xufTtcblxuZXhwb3J0cy5kZWZhdWx0ID0gd2FybjsiLCIndXNlIHN0cmljdCc7XG5cbnZhciBfd2FybiA9IHJlcXVpcmUoJy4vdXRpbHMvd2FybicpO1xuXG52YXIgX3dhcm4yID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfd2Fybik7XG5cbmZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9XG5cbi8vIGh0dHBzOi8vZGV2ZWxvcGVycy5nb29nbGUuY29tL3RhZy1tYW5hZ2VyL3F1aWNrc3RhcnRcblxudmFyIFNuaXBwZXRzID0ge1xuICB0YWdzOiBmdW5jdGlvbiB0YWdzKF9yZWYpIHtcbiAgICB2YXIgaWQgPSBfcmVmLmlkLFxuICAgICAgICBldmVudHMgPSBfcmVmLmV2ZW50cyxcbiAgICAgICAgZGF0YUxheWVyID0gX3JlZi5kYXRhTGF5ZXIsXG4gICAgICAgIGRhdGFMYXllck5hbWUgPSBfcmVmLmRhdGFMYXllck5hbWUsXG4gICAgICAgIHByZXZpZXcgPSBfcmVmLnByZXZpZXcsXG4gICAgICAgIGF1dGggPSBfcmVmLmF1dGg7XG5cbiAgICB2YXIgZ3RtX2F1dGggPSAnJmd0bV9hdXRoPScgKyBhdXRoO1xuICAgIHZhciBndG1fcHJldmlldyA9ICcmZ3RtX3ByZXZpZXc9JyArIHByZXZpZXc7XG5cbiAgICBpZiAoIWlkKSAoMCwgX3dhcm4yLmRlZmF1bHQpKCdHVE0gSWQgaXMgcmVxdWlyZWQnKTtcblxuICAgIHZhciBpZnJhbWUgPSAnXFxuICAgICAgPGlmcmFtZSBzcmM9XCJodHRwczovL3d3dy5nb29nbGV0YWdtYW5hZ2VyLmNvbS9ucy5odG1sP2lkPScgKyBpZCArIGd0bV9hdXRoICsgZ3RtX3ByZXZpZXcgKyAnJmd0bV9jb29raWVzX3dpbj14XCJcXG4gICAgICAgIGhlaWdodD1cIjBcIiB3aWR0aD1cIjBcIiBzdHlsZT1cImRpc3BsYXk6bm9uZTt2aXNpYmlsaXR5OmhpZGRlblwiIGlkPVwidGFnLW1hbmFnZXJcIj48L2lmcmFtZT4nO1xuXG4gICAgdmFyIHNjcmlwdCA9ICdcXG4gICAgICAoZnVuY3Rpb24odyxkLHMsbCxpKXt3W2xdPXdbbF18fFtdO1xcbiAgICAgICAgd1tsXS5wdXNoKHtcXCdndG0uc3RhcnRcXCc6IG5ldyBEYXRlKCkuZ2V0VGltZSgpLGV2ZW50OlxcJ2d0bS5qc1xcJywgJyArIEpTT04uc3RyaW5naWZ5KGV2ZW50cykuc2xpY2UoMSwgLTEpICsgJ30pO1xcbiAgICAgICAgdmFyIGY9ZC5nZXRFbGVtZW50c0J5VGFnTmFtZShzKVswXSxqPWQuY3JlYXRlRWxlbWVudChzKSxkbD1sIT1cXCdkYXRhTGF5ZXJcXCc/XFwnJmw9XFwnK2w6XFwnXFwnO1xcbiAgICAgICAgai5hc3luYz10cnVlO2ouc3JjPVxcJ2h0dHBzOi8vd3d3Lmdvb2dsZXRhZ21hbmFnZXIuY29tL2d0bS5qcz9pZD1cXCcraStkbCtcXCcnICsgZ3RtX2F1dGggKyBndG1fcHJldmlldyArICcmZ3RtX2Nvb2tpZXNfd2luPXhcXCc7XFxuICAgICAgICBmLnBhcmVudE5vZGUuaW5zZXJ0QmVmb3JlKGosZik7XFxuICAgICAgfSkod2luZG93LGRvY3VtZW50LFxcJ3NjcmlwdFxcJyxcXCcnICsgZGF0YUxheWVyTmFtZSArICdcXCcsXFwnJyArIGlkICsgJ1xcJyk7JztcblxuICAgIHZhciBkYXRhTGF5ZXJWYXIgPSB0aGlzLmRhdGFMYXllcihkYXRhTGF5ZXIsIGRhdGFMYXllck5hbWUpO1xuXG4gICAgcmV0dXJuIHtcbiAgICAgIGlmcmFtZTogaWZyYW1lLFxuICAgICAgc2NyaXB0OiBzY3JpcHQsXG4gICAgICBkYXRhTGF5ZXJWYXI6IGRhdGFMYXllclZhclxuICAgIH07XG4gIH0sXG4gIGRhdGFMYXllcjogZnVuY3Rpb24gZGF0YUxheWVyKF9kYXRhTGF5ZXIsIGRhdGFMYXllck5hbWUpIHtcbiAgICByZXR1cm4gJ1xcbiAgICAgIHdpbmRvdy4nICsgZGF0YUxheWVyTmFtZSArICcgPSB3aW5kb3cuJyArIGRhdGFMYXllck5hbWUgKyAnIHx8IFtdO1xcbiAgICAgIHdpbmRvdy4nICsgZGF0YUxheWVyTmFtZSArICcucHVzaCgnICsgSlNPTi5zdHJpbmdpZnkoX2RhdGFMYXllcikgKyAnKSc7XG4gIH1cbn07XG5cbm1vZHVsZS5leHBvcnRzID0gU25pcHBldHM7IiwiJ3VzZSBzdHJpY3QnO1xuXG52YXIgX1NuaXBwZXRzID0gcmVxdWlyZSgnLi9TbmlwcGV0cycpO1xuXG52YXIgX1NuaXBwZXRzMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX1NuaXBwZXRzKTtcblxuZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH1cblxudmFyIFRhZ01hbmFnZXIgPSB7XG4gIGRhdGFTY3JpcHQ6IGZ1bmN0aW9uIGRhdGFTY3JpcHQoZGF0YUxheWVyKSB7XG4gICAgdmFyIHNjcmlwdCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NjcmlwdCcpO1xuICAgIHNjcmlwdC5pbm5lckhUTUwgPSBkYXRhTGF5ZXI7XG4gICAgcmV0dXJuIHNjcmlwdDtcbiAgfSxcbiAgZ3RtOiBmdW5jdGlvbiBndG0oYXJncykge1xuICAgIHZhciBzbmlwcGV0cyA9IF9TbmlwcGV0czIuZGVmYXVsdC50YWdzKGFyZ3MpO1xuXG4gICAgdmFyIG5vU2NyaXB0ID0gZnVuY3Rpb24gbm9TY3JpcHQoKSB7XG4gICAgICB2YXIgbm9zY3JpcHQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdub3NjcmlwdCcpO1xuICAgICAgbm9zY3JpcHQuaW5uZXJIVE1MID0gc25pcHBldHMuaWZyYW1lO1xuICAgICAgcmV0dXJuIG5vc2NyaXB0O1xuICAgIH07XG5cbiAgICB2YXIgc2NyaXB0ID0gZnVuY3Rpb24gc2NyaXB0KCkge1xuICAgICAgdmFyIHNjcmlwdCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NjcmlwdCcpO1xuICAgICAgc2NyaXB0LmlubmVySFRNTCA9IHNuaXBwZXRzLnNjcmlwdDtcbiAgICAgIHJldHVybiBzY3JpcHQ7XG4gICAgfTtcblxuICAgIHZhciBkYXRhU2NyaXB0ID0gdGhpcy5kYXRhU2NyaXB0KHNuaXBwZXRzLmRhdGFMYXllclZhcik7XG5cbiAgICByZXR1cm4ge1xuICAgICAgbm9TY3JpcHQ6IG5vU2NyaXB0LFxuICAgICAgc2NyaXB0OiBzY3JpcHQsXG4gICAgICBkYXRhU2NyaXB0OiBkYXRhU2NyaXB0XG4gICAgfTtcbiAgfSxcbiAgaW5pdGlhbGl6ZTogZnVuY3Rpb24gaW5pdGlhbGl6ZShfcmVmKSB7XG4gICAgdmFyIGd0bUlkID0gX3JlZi5ndG1JZCxcbiAgICAgICAgX3JlZiRldmVudHMgPSBfcmVmLmV2ZW50cyxcbiAgICAgICAgZXZlbnRzID0gX3JlZiRldmVudHMgPT09IHVuZGVmaW5lZCA/IHt9IDogX3JlZiRldmVudHMsXG4gICAgICAgIGRhdGFMYXllciA9IF9yZWYuZGF0YUxheWVyLFxuICAgICAgICBfcmVmJGRhdGFMYXllck5hbWUgPSBfcmVmLmRhdGFMYXllck5hbWUsXG4gICAgICAgIGRhdGFMYXllck5hbWUgPSBfcmVmJGRhdGFMYXllck5hbWUgPT09IHVuZGVmaW5lZCA/ICdkYXRhTGF5ZXInIDogX3JlZiRkYXRhTGF5ZXJOYW1lLFxuICAgICAgICBfcmVmJGF1dGggPSBfcmVmLmF1dGgsXG4gICAgICAgIGF1dGggPSBfcmVmJGF1dGggPT09IHVuZGVmaW5lZCA/ICcnIDogX3JlZiRhdXRoLFxuICAgICAgICBfcmVmJHByZXZpZXcgPSBfcmVmLnByZXZpZXcsXG4gICAgICAgIHByZXZpZXcgPSBfcmVmJHByZXZpZXcgPT09IHVuZGVmaW5lZCA/ICcnIDogX3JlZiRwcmV2aWV3O1xuXG4gICAgdmFyIGd0bSA9IHRoaXMuZ3RtKHtcbiAgICAgIGlkOiBndG1JZCxcbiAgICAgIGV2ZW50czogZXZlbnRzLFxuICAgICAgZGF0YUxheWVyOiBkYXRhTGF5ZXIgfHwgdW5kZWZpbmVkLFxuICAgICAgZGF0YUxheWVyTmFtZTogZGF0YUxheWVyTmFtZSxcbiAgICAgIGF1dGg6IGF1dGgsXG4gICAgICBwcmV2aWV3OiBwcmV2aWV3XG4gICAgfSk7XG4gICAgaWYgKGRhdGFMYXllcikgZG9jdW1lbnQuaGVhZC5hcHBlbmRDaGlsZChndG0uZGF0YVNjcmlwdCk7XG4gICAgZG9jdW1lbnQuaGVhZC5pbnNlcnRCZWZvcmUoZ3RtLnNjcmlwdCgpLCBkb2N1bWVudC5oZWFkLmNoaWxkTm9kZXNbMF0pO1xuICAgIGRvY3VtZW50LmJvZHkuaW5zZXJ0QmVmb3JlKGd0bS5ub1NjcmlwdCgpLCBkb2N1bWVudC5ib2R5LmNoaWxkTm9kZXNbMF0pO1xuICB9LFxuICBkYXRhTGF5ZXI6IGZ1bmN0aW9uIGRhdGFMYXllcihfcmVmMikge1xuICAgIHZhciBfZGF0YUxheWVyID0gX3JlZjIuZGF0YUxheWVyLFxuICAgICAgICBfcmVmMiRkYXRhTGF5ZXJOYW1lID0gX3JlZjIuZGF0YUxheWVyTmFtZSxcbiAgICAgICAgZGF0YUxheWVyTmFtZSA9IF9yZWYyJGRhdGFMYXllck5hbWUgPT09IHVuZGVmaW5lZCA/ICdkYXRhTGF5ZXInIDogX3JlZjIkZGF0YUxheWVyTmFtZTtcblxuICAgIGlmICh3aW5kb3dbZGF0YUxheWVyTmFtZV0pIHJldHVybiB3aW5kb3dbZGF0YUxheWVyTmFtZV0ucHVzaChfZGF0YUxheWVyKTtcbiAgICB2YXIgc25pcHBldHMgPSBfU25pcHBldHMyLmRlZmF1bHQuZGF0YUxheWVyKF9kYXRhTGF5ZXIsIGRhdGFMYXllck5hbWUpO1xuICAgIHZhciBkYXRhU2NyaXB0ID0gdGhpcy5kYXRhU2NyaXB0KHNuaXBwZXRzKTtcbiAgICBkb2N1bWVudC5oZWFkLmluc2VydEJlZm9yZShkYXRhU2NyaXB0LCBkb2N1bWVudC5oZWFkLmNoaWxkTm9kZXNbMF0pO1xuICB9XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IFRhZ01hbmFnZXI7IiwiJ3VzZSBzdHJpY3QnO1xuXG52YXIgX1RhZ01hbmFnZXIgPSByZXF1aXJlKCcuL1RhZ01hbmFnZXInKTtcblxudmFyIF9UYWdNYW5hZ2VyMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX1RhZ01hbmFnZXIpO1xuXG5mdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfVxuXG5tb2R1bGUuZXhwb3J0cyA9IF9UYWdNYW5hZ2VyMi5kZWZhdWx0OyIsImltcG9ydCB7IHVzZUVmZmVjdCB9IGZyb20gXCJyZWFjdFwiO1xyXG5pbXBvcnQgVGFnTWFuYWdlciBmcm9tICdyZWFjdC1ndG0tbW9kdWxlJ1xyXG5cclxuY29uc3QgSW5pdGlhbGl6ZUdUTSA9ICggcHJvcHMgKSA9PiB7XHJcblxyXG4gIHVzZUVmZmVjdCgoKSA9PiB7XHJcblxyXG4gICAgaWYgKCFteC5nYTRDb25uZWN0ZWQpIHsgLy8gZmxhZyB0byBwcmV2ZW50IG9uTmF2aWdhdGlvbiBmcm9tIHNlbmRpbmcgbXVsdGlwbGUgcGFnZSB2aWV3cyBhZnRlciB0aGluZ3MgbGlrZSBhZnRlciB3aWRnZXQgbG9hZCwgYWZ0ZXIgc2hvdyBwYWdlLCBldGMuXHJcbiAgICAgIFxyXG4gICAgICAvLyBkYXRhVW5hdmFpbGFibGUgY2hlY2sgaGVyZSBiZWNhdXNlIHRoZSByZW5kZXIgZnVuY3Rpb24gd2lsbCB0YWtlIGNhcmUgb2YgY2FsbGluZyBpdCBtdWx0aXBsZSB0aW1lc1xyXG4gICAgICBsZXQgZGF0YVVuYXZhaWxhYmxlID0gZmFsc2U7XHJcbiAgICAgIGZvciAobGV0IG9iamVjdCBvZiBwcm9wcy5hZGRpdGlvbmFsUHJvcHMpIHtcclxuICAgICAgICBpZiAob2JqZWN0LnByb3BEYXRhU291cmNlLnN0YXR1cyAhPT0gJ2F2YWlsYWJsZScpIHtcclxuICAgICAgICAgIGRhdGFVbmF2YWlsYWJsZSA9IHRydWU7XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcblxyXG4gICAgICBpZiAoIWRhdGFVbmF2YWlsYWJsZSkge1xyXG5cclxuICAgICAgICBjb25zdCBvcmlnT25OYXZpZ2F0aW9uID0gbXgudWkuZ2V0Q29udGVudEZvcm0oKS5vbk5hdmlnYXRpb247IC8vIHNhdmUgd2hhdCB0aGUgb3JpZ2luYWwgb25OYXZpZ2F0aW9uIGZ1bmN0aW9uIGRpZFxyXG4gICAgICAgIG14LnVpLmdldENvbnRlbnRGb3JtKCkub25OYXZpZ2F0aW9uID0gKCkgPT4ge1xyXG4gICAgICAgICAgXHJcbiAgICAgICAgICAvLyBDdXN0b20gQWN0aW9uc1xyXG4gICAgICAgICAgaWYgKHByb3BzLnNlbmRDdXN0b21Qcm9wcyA9PT0gZmFsc2UpIHtcclxuICAgICAgICAgICAgY29uc3QgdGFnTWFuYWdlckFyZ3NJbml0aWFsaXplID0ge1xyXG4gICAgICAgICAgICAgIGd0bUlkOiBwcm9wcy5tZWFzdXJlbWVudElEXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIFRhZ01hbmFnZXIuaW5pdGlhbGl6ZSh0YWdNYW5hZ2VyQXJnc0luaXRpYWxpemUpXHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgICBcclxuICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICBsZXQgZGF0YUxheWVyU3RydWN0dXJlID0gZnVuY3Rpb24ocHJvcHMpIHtcclxuICAgICAgICAgICAgICB2YXIgZGF0YUxheWVyID0gJ3tcImV2ZW50XCI6XCInICsgcHJvcHMucGFnZVZpZXdFdmVudE5hbWUgKyAnXCIsJzsgLy8gaW5pdGlhbGl6ZSB0aGUgZGF0YUxheWVyIHZhcmlhYmxlXHJcblxyXG4gICAgICAgICAgICAgIGlmIChwcm9wcy5zZW5kUGFnZVRpdGxlKSB7IC8vIHNlbmQgcGFnZSB0aXRsZVxyXG4gICAgICAgICAgICAgICAgZGF0YUxheWVyICs9ICdcIlBhZ2UgTmFtZVwiOlwiJyArIG14LnVpLmdldENvbnRlbnRGb3JtKCkudGl0bGUgKyAnXCIsJztcclxuICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgIGlmIChwcm9wcy5zZW5kTW9kdWxlTG9jYXRpb24pIHsgLy8gc2VuZCBtb2R1bGUgbG9jYXRpb25cclxuICAgICAgICAgICAgICAgIHZhciBtb2R1bGVQYXRoID0gbXgudWkuZ2V0Q29udGVudEZvcm0oKS5wYXRoO1xyXG4gICAgICAgICAgICAgICAgdmFyIG1vZHVsZUxvY2F0aW9uID0gKGZ1bmN0aW9uKG1vZHVsZVBhdGgpIHtcclxuICAgICAgICAgICAgICAgICAgdmFyIHBhZ2VFeHRlbnNpb24gPSBcIi5wYWdlLnhtbFwiO1xyXG4gICAgICAgICAgICAgICAgICB2YXIgcGF0aCA9IG1vZHVsZVBhdGguc3Vic3RyKDAsIG1vZHVsZVBhdGgubGVuZ3RoIC0gcGFnZUV4dGVuc2lvbi5sZW5ndGgpO1xyXG4gICAgICAgICAgICAgICAgICByZXR1cm4gcGF0aDtcclxuICAgICAgICAgICAgICAgIH0obW9kdWxlUGF0aCkpO1xyXG4gICAgICAgICAgICAgICAgZGF0YUxheWVyICs9ICdcIk1vZHVsZSBMb2NhdGlvblwiOlwiJyArIG1vZHVsZUxvY2F0aW9uICsgJ1wiLCc7XHJcbiAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICBpZiAocHJvcHMuc2VuZFBhZ2VVUkwpIHsgLy8gc2VuZCBwYWdlIFVSTFxyXG4gICAgICAgICAgICAgICAgaWYgKG14LnVpLmdldENvbnRlbnRGb3JtKCkudXJsICE9PSBudWxsKSB7XHJcbiAgICAgICAgICAgICAgICAgIHZhciBwYWdlVVJMID0gd2luZG93LmxvY2F0aW9uLm9yaWdpbiArIG14LnVpLmdldENvbnRlbnRGb3JtKCkudXJsO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgdmFyIHBhZ2VVUkwgPSB3aW5kb3cubG9jYXRpb24ub3JpZ2luO1xyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIHZhciB0cmltbWVkVVJMID0gKGZ1bmN0aW9uKGZ1bGxVUkwpIHtcclxuICAgICAgICAgICAgICAgICAgdmFyIGxhc3RDaGFySW5kZXggPSBmdWxsVVJMLmxhc3RJbmRleE9mKFwiL1wiKTtcclxuICAgICAgICAgICAgICAgICAgdmFyIGVuZFN0cmluZyA9IGZ1bGxVUkwuc3Vic3RyaW5nKGxhc3RDaGFySW5kZXggKyAxLGZ1bGxVUkwubGVuZ3RoKTtcclxuICAgICAgICAgICAgICAgICAgaWYgKGlzTmFOKGVuZFN0cmluZykpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZnVsbFVSTDsgLy8gdGhlIGVuZCBvZiB0aGUgc3RyaW5nIGlzbid0IGEgbnVtYmVyLCByZXR1cm4gdGhlIHdob2xlIHRoaW5nXHJcbiAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZ1bGxQYXRoLnN1YnN0cigwLGxhc3RDaGFySW5kZXgpOyAvLyB0aGUgZW5kIG9mIHRoZSBzdHJpbmcgaXMgYSBudW1iZXIsIHRyaW0gaXRcclxuICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfShwYWdlVVJMKSk7XHJcbiAgICAgICAgICAgICAgICBkYXRhTGF5ZXIgKz0gJ1wiUGFnZSBVUkxcIjpcIicgKyB0cmltbWVkVVJMICsgJ1wiLCc7XHJcbiAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICBpZiAocHJvcHMuc2VuZFNlc3Npb25JRCkgeyAvLyBzZW5kIHNlc3Npb24gSURcclxuICAgICAgICAgICAgICAgIGRhdGFMYXllciArPSAnXCJTZXNzaW9uIElEXCI6XCInICsgbXguc2Vzc2lvbi5nZXRTZXNzaW9uT2JqZWN0SWQoKSArICdcIiwnO1xyXG4gICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgaWYgKHByb3BzLnNlbmRBZGRpdGlvbmFsUHJvcHMpIHsgLy8gc2VuZCBhZGRpdGlvbmFsIHByb3BlcnRpZXNcclxuICAgICAgICAgICAgICAgIGxldCBleHByZXNzaW9uUmVzdWx0PSAnJztcclxuXHJcbiAgICAgICAgICAgICAgICBmb3IgKGxldCBsaW5lIG9mIHByb3BzLmFkZGl0aW9uYWxQcm9wcykge1xyXG4gICAgICAgICAgICAgICAgICBmb3IgKGxldCBvYmplY3Qgb2YgbGluZS5wcm9wRGF0YVNvdXJjZS5pdGVtcykgeyAvLyBvYmplY3QgaXMgYW4gaXRlbSBpbiB0aGUgbGlzdCB0aGF0IGlzIHJldHVybmVkIGZyb20gdGhlIGRhdGEgc291cmNlXHJcbiAgICAgICAgICAgICAgICAgICAgZXhwcmVzc2lvblJlc3VsdCArPSBsaW5lLnByb3BWYWx1ZS5nZXQob2JqZWN0KS52YWx1ZSArICcsICc7XHJcbiAgICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAgIGV4cHJlc3Npb25SZXN1bHQgPSBleHByZXNzaW9uUmVzdWx0LnJlcGxhY2UoLyxcXHMqJC8sIFwiXCIpO1xyXG4gICAgICAgICAgICAgICAgICBkYXRhTGF5ZXIgKz0gJ1wiJyArIGxpbmUucHJvcE5hbWUgKyAnXCI6XCInICsgZXhwcmVzc2lvblJlc3VsdCArICdcIiwnO1xyXG4gICAgICAgICAgICAgICAgICBleHByZXNzaW9uUmVzdWx0ID0gJyc7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAgIGRhdGFMYXllciA9IGRhdGFMYXllci5yZXBsYWNlKC8sXFxzKiQvLCBcIlwiKTsgLy8gcmVtb3ZlIHRoZSBsYXN0IGNvbW1hIGZyb20gdGhlIGRhdGFMYXllciB2YXJpYWJsZVxyXG4gICAgICAgICAgICAgIGRhdGFMYXllciArPSBcIn1cIlxyXG4gICAgICAgICAgICAgIHJldHVybiBKU09OLnBhcnNlKGRhdGFMYXllcik7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGxldCBkYXRhTGF5ZXIgPSBkYXRhTGF5ZXJTdHJ1Y3R1cmUocHJvcHMpO1xyXG5cclxuICAgICAgICAgICAgY29uc3QgdGFnTWFuYWdlckFyZ3MgPSB7XHJcbiAgICAgICAgICAgICAgZ3RtSWQ6IHByb3BzLm1lYXN1cmVtZW50SUQsXHJcbiAgICAgICAgICAgICAgZGF0YUxheWVyXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIFRhZ01hbmFnZXIuaW5pdGlhbGl6ZSh0YWdNYW5hZ2VyQXJncylcclxuICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICBteC5nYTRDb25uZWN0ZWQgPSB0cnVlOyAvLyBXZSBoYXZlIHNlbnQgdGhlIHBhZ2UgaGl0LCBub3cgdG9nZ2xlIHRoZSBzd2l0Y2ggb2ZmIHRvIGF2b2lkIHNlbmRpbmcgZHVwbGljYXRlc1xyXG5cclxuICAgICAgICAgIC8vIE9yaWdpbmFsIEFjdGlvbnNcclxuICAgICAgICAgIG9yaWdPbk5hdmlnYXRpb24oKTtcclxuICAgICAgICBcclxuXHJcbiAgICAgICAgICByZXR1cm4gKCkgPT4ge1xyXG4gICAgICAgICAgICBudWxsO1xyXG4gICAgICAgICAgfSBcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgIH1cclxuICB9KTsgLy8gbm8gZGVwZW5kZW5jeSBhcnJheSAtPiB0cmlnZ2VyIG9uIGV2ZXJ5IGxvYWRcclxuXHJcbiAgcmV0dXJuIG51bGw7XHJcbn1cclxuXHJcbmV4cG9ydCBkZWZhdWx0IEluaXRpYWxpemVHVE0iLCJpbXBvcnQgeyBjcmVhdGVFbGVtZW50IH0gZnJvbSBcInJlYWN0XCI7XG5pbXBvcnQgSW5pdGlhbGl6ZUdUTSBmcm9tIFwiLi9jb21wb25lbnRzL0luaXRpYWxpemVHVE1cIjtcblxuZXhwb3J0IGZ1bmN0aW9uIEdvb2dsZVRhZ01hbmFnZXIoeyBtZWFzdXJlbWVudElELCBzZW5kQ3VzdG9tUHJvcHMsIHBhZ2VWaWV3RXZlbnROYW1lLCBzZW5kUGFnZVRpdGxlLCBzZW5kTW9kdWxlTG9jYXRpb24sIHNlbmRQYWdlVVJMLCBzZW5kU2Vzc2lvbklELCBzZW5kQWRkaXRpb25hbFByb3BzLCBhZGRpdGlvbmFsUHJvcHMgfSkge1xuICAgIHJldHVybiA8SW5pdGlhbGl6ZUdUTSBtZWFzdXJlbWVudElEPXttZWFzdXJlbWVudElEfSBzZW5kQ3VzdG9tUHJvcHM9e3NlbmRDdXN0b21Qcm9wc30gcGFnZVZpZXdFdmVudE5hbWU9e3BhZ2VWaWV3RXZlbnROYW1lfSBzZW5kUGFnZVRpdGxlPXtzZW5kUGFnZVRpdGxlfSBzZW5kTW9kdWxlTG9jYXRpb249e3NlbmRNb2R1bGVMb2NhdGlvbn0gc2VuZFBhZ2VVUkw9e3NlbmRQYWdlVVJMfSBzZW5kU2Vzc2lvbklEPXtzZW5kU2Vzc2lvbklEfSBzZW5kQWRkaXRpb25hbFByb3BzPXtzZW5kQWRkaXRpb25hbFByb3BzfSBhZGRpdGlvbmFsUHJvcHM9e2FkZGl0aW9uYWxQcm9wc30gLz47XG59Il0sIm5hbWVzIjpbIk9iamVjdCIsImRlZmluZVByb3BlcnR5IiwiZXhwb3J0cyIsInZhbHVlIiwid2FybiIsInMiLCJjb25zb2xlIiwiX3dhcm4iLCJyZXF1aXJlIiwiX3dhcm4yIiwiX2ludGVyb3BSZXF1aXJlRGVmYXVsdCIsIm9iaiIsIl9fZXNNb2R1bGUiLCJkZWZhdWx0IiwiU25pcHBldHMiLCJ0YWdzIiwiX3JlZiIsImlkIiwiZXZlbnRzIiwiZGF0YUxheWVyIiwiZGF0YUxheWVyTmFtZSIsInByZXZpZXciLCJhdXRoIiwiZ3RtX2F1dGgiLCJndG1fcHJldmlldyIsImlmcmFtZSIsInNjcmlwdCIsIkpTT04iLCJzdHJpbmdpZnkiLCJzbGljZSIsImRhdGFMYXllclZhciIsIl9kYXRhTGF5ZXIiLCJtb2R1bGUiLCJfU25pcHBldHMiLCJfU25pcHBldHMyIiwiVGFnTWFuYWdlciIsImRhdGFTY3JpcHQiLCJkb2N1bWVudCIsImNyZWF0ZUVsZW1lbnQiLCJpbm5lckhUTUwiLCJndG0iLCJhcmdzIiwic25pcHBldHMiLCJub1NjcmlwdCIsIm5vc2NyaXB0IiwiaW5pdGlhbGl6ZSIsImd0bUlkIiwiX3JlZiRldmVudHMiLCJ1bmRlZmluZWQiLCJfcmVmJGRhdGFMYXllck5hbWUiLCJfcmVmJGF1dGgiLCJfcmVmJHByZXZpZXciLCJoZWFkIiwiYXBwZW5kQ2hpbGQiLCJpbnNlcnRCZWZvcmUiLCJjaGlsZE5vZGVzIiwiYm9keSIsIl9yZWYyIiwiX3JlZjIkZGF0YUxheWVyTmFtZSIsIndpbmRvdyIsInB1c2giLCJfVGFnTWFuYWdlciIsIl9UYWdNYW5hZ2VyMiIsIkluaXRpYWxpemVHVE0iLCJwcm9wcyIsInVzZUVmZmVjdCIsIm14IiwiZ2E0Q29ubmVjdGVkIiwiZGF0YVVuYXZhaWxhYmxlIiwib2JqZWN0IiwiYWRkaXRpb25hbFByb3BzIiwicHJvcERhdGFTb3VyY2UiLCJzdGF0dXMiLCJvcmlnT25OYXZpZ2F0aW9uIiwidWkiLCJnZXRDb250ZW50Rm9ybSIsIm9uTmF2aWdhdGlvbiIsInNlbmRDdXN0b21Qcm9wcyIsInRhZ01hbmFnZXJBcmdzSW5pdGlhbGl6ZSIsIm1lYXN1cmVtZW50SUQiLCJkYXRhTGF5ZXJTdHJ1Y3R1cmUiLCJwYWdlVmlld0V2ZW50TmFtZSIsInNlbmRQYWdlVGl0bGUiLCJ0aXRsZSIsInNlbmRNb2R1bGVMb2NhdGlvbiIsIm1vZHVsZVBhdGgiLCJwYXRoIiwibW9kdWxlTG9jYXRpb24iLCJwYWdlRXh0ZW5zaW9uIiwic3Vic3RyIiwibGVuZ3RoIiwic2VuZFBhZ2VVUkwiLCJ1cmwiLCJwYWdlVVJMIiwibG9jYXRpb24iLCJvcmlnaW4iLCJ0cmltbWVkVVJMIiwiZnVsbFVSTCIsImxhc3RDaGFySW5kZXgiLCJsYXN0SW5kZXhPZiIsImVuZFN0cmluZyIsInN1YnN0cmluZyIsImlzTmFOIiwiZnVsbFBhdGgiLCJzZW5kU2Vzc2lvbklEIiwic2Vzc2lvbiIsImdldFNlc3Npb25PYmplY3RJZCIsInNlbmRBZGRpdGlvbmFsUHJvcHMiLCJleHByZXNzaW9uUmVzdWx0IiwibGluZSIsIml0ZW1zIiwicHJvcFZhbHVlIiwiZ2V0IiwicmVwbGFjZSIsInByb3BOYW1lIiwicGFyc2UiLCJ0YWdNYW5hZ2VyQXJncyIsIkdvb2dsZVRhZ01hbmFnZXIiXSwibWFwcGluZ3MiOiI7Ozs7QUFFQUEsTUFBTSxDQUFDQyxjQUFQLENBQXNCQyxNQUF0QixFQUErQixZQUEvQixFQUE2QztBQUMzQ0MsRUFBQUEsS0FBSyxFQUFFO0FBRG9DLENBQTdDOztBQUdBLElBQUlDLElBQUksR0FBRyxTQUFTQSxJQUFULENBQWNDLENBQWQsRUFBaUI7QUFDMUJDLEVBQUFBLE9BQU8sQ0FBQ0YsSUFBUixDQUFhLGFBQWIsRUFBNEJDLENBQTVCO0FBQ0QsQ0FGRDs7Y0FJQSxHQUFrQkQ7O0FDUGxCLElBQUlHLEtBQUssR0FBR0MsTUFBWjs7QUFFQSxJQUFJQyxNQUFNLEdBQUdDLHdCQUFzQixDQUFDSCxLQUFELENBQW5DOztBQUVBLFNBQVNHLHdCQUFULENBQWdDQyxHQUFoQyxFQUFxQztBQUFFLFNBQU9BLEdBQUcsSUFBSUEsR0FBRyxDQUFDQyxVQUFYLEdBQXdCRCxHQUF4QixHQUE4QjtBQUFFRSxJQUFBQSxPQUFPLEVBQUVGO0FBQVgsR0FBckM7QUFBd0Q7OztBQUkvRixJQUFJRyxRQUFRLEdBQUc7QUFDYkMsRUFBQUEsSUFBSSxFQUFFLFNBQVNBLElBQVQsQ0FBY0MsSUFBZCxFQUFvQjtBQUN4QixRQUFJQyxFQUFFLEdBQUdELElBQUksQ0FBQ0MsRUFBZDtBQUFBLFFBQ0lDLE1BQU0sR0FBR0YsSUFBSSxDQUFDRSxNQURsQjtBQUFBLFFBRUlDLFNBQVMsR0FBR0gsSUFBSSxDQUFDRyxTQUZyQjtBQUFBLFFBR0lDLGFBQWEsR0FBR0osSUFBSSxDQUFDSSxhQUh6QjtBQUFBLFFBSUlDLE9BQU8sR0FBR0wsSUFBSSxDQUFDSyxPQUpuQjtBQUFBLFFBS0lDLElBQUksR0FBR04sSUFBSSxDQUFDTSxJQUxoQjtBQU9BLFFBQUlDLFFBQVEsR0FBRyxlQUFlRCxJQUE5QjtBQUNBLFFBQUlFLFdBQVcsR0FBRyxrQkFBa0JILE9BQXBDO0FBRUEsUUFBSSxDQUFDSixFQUFMLEVBQVMsSUFBSVIsTUFBTSxDQUFDSSxPQUFYLEVBQW9CLG9CQUFwQjtBQUVULFFBQUlZLE1BQU0sR0FBRyxzRUFBc0VSLEVBQXRFLEdBQTJFTSxRQUEzRSxHQUFzRkMsV0FBdEYsR0FBb0cscUhBQWpIO0FBRUEsUUFBSUUsTUFBTSxHQUFHLDJIQUEySEMsSUFBSSxDQUFDQyxTQUFMLENBQWVWLE1BQWYsRUFBdUJXLEtBQXZCLENBQTZCLENBQTdCLEVBQWdDLENBQUMsQ0FBakMsQ0FBM0gsR0FBaUssOExBQWpLLEdBQWtXTixRQUFsVyxHQUE2V0MsV0FBN1csR0FBMlgsd0dBQTNYLEdBQXNlSixhQUF0ZSxHQUFzZixPQUF0ZixHQUFnZ0JILEVBQWhnQixHQUFxZ0IsTUFBbGhCO0FBRUEsUUFBSWEsWUFBWSxHQUFHLEtBQUtYLFNBQUwsQ0FBZUEsU0FBZixFQUEwQkMsYUFBMUIsQ0FBbkI7QUFFQSxXQUFPO0FBQ0xLLE1BQUFBLE1BQU0sRUFBRUEsTUFESDtBQUVMQyxNQUFBQSxNQUFNLEVBQUVBLE1BRkg7QUFHTEksTUFBQUEsWUFBWSxFQUFFQTtBQUhULEtBQVA7QUFLRCxHQXpCWTtBQTBCYlgsRUFBQUEsU0FBUyxFQUFFLFNBQVNBLFNBQVQsQ0FBbUJZLFVBQW5CLEVBQStCWCxhQUEvQixFQUE4QztBQUN2RCxXQUFPLG9CQUFvQkEsYUFBcEIsR0FBb0MsWUFBcEMsR0FBbURBLGFBQW5ELEdBQW1FLHdCQUFuRSxHQUE4RkEsYUFBOUYsR0FBOEcsUUFBOUcsR0FBeUhPLElBQUksQ0FBQ0MsU0FBTCxDQUFlRyxVQUFmLENBQXpILEdBQXNKLEdBQTdKO0FBQ0Q7QUE1QlksQ0FBZjtJQStCQUMsVUFBQSxHQUFpQmxCLFFBQWpCOztBQ3ZDQSxJQUFJbUIsU0FBUyxHQUFHekIsVUFBaEI7O0FBRUEsSUFBSTBCLFVBQVUsR0FBR3hCLHdCQUFzQixDQUFDdUIsU0FBRCxDQUF2Qzs7QUFFQSxTQUFTdkIsd0JBQVQsQ0FBZ0NDLEdBQWhDLEVBQXFDO0FBQUUsU0FBT0EsR0FBRyxJQUFJQSxHQUFHLENBQUNDLFVBQVgsR0FBd0JELEdBQXhCLEdBQThCO0FBQUVFLElBQUFBLE9BQU8sRUFBRUY7QUFBWCxHQUFyQztBQUF3RDs7QUFFL0YsSUFBSXdCLFVBQVUsR0FBRztBQUNmQyxFQUFBQSxVQUFVLEVBQUUsU0FBU0EsVUFBVCxDQUFvQmpCLFNBQXBCLEVBQStCO0FBQ3pDLFFBQUlPLE1BQU0sR0FBR1csUUFBUSxDQUFDQyxhQUFULENBQXVCLFFBQXZCLENBQWI7QUFDQVosSUFBQUEsTUFBTSxDQUFDYSxTQUFQLEdBQW1CcEIsU0FBbkI7QUFDQSxXQUFPTyxNQUFQO0FBQ0QsR0FMYztBQU1mYyxFQUFBQSxHQUFHLEVBQUUsU0FBU0EsR0FBVCxDQUFhQyxJQUFiLEVBQW1CO0FBQ3RCLFFBQUlDLFFBQVEsR0FBR1IsVUFBVSxDQUFDckIsT0FBWCxDQUFtQkUsSUFBbkIsQ0FBd0IwQixJQUF4QixDQUFmOztBQUVBLFFBQUlFLFFBQVEsR0FBRyxTQUFTQSxRQUFULEdBQW9CO0FBQ2pDLFVBQUlDLFFBQVEsR0FBR1AsUUFBUSxDQUFDQyxhQUFULENBQXVCLFVBQXZCLENBQWY7QUFDQU0sTUFBQUEsUUFBUSxDQUFDTCxTQUFULEdBQXFCRyxRQUFRLENBQUNqQixNQUE5QjtBQUNBLGFBQU9tQixRQUFQO0FBQ0QsS0FKRDs7QUFNQSxRQUFJbEIsTUFBTSxHQUFHLFNBQVNBLE1BQVQsR0FBa0I7QUFDN0IsVUFBSUEsTUFBTSxHQUFHVyxRQUFRLENBQUNDLGFBQVQsQ0FBdUIsUUFBdkIsQ0FBYjtBQUNBWixNQUFBQSxNQUFNLENBQUNhLFNBQVAsR0FBbUJHLFFBQVEsQ0FBQ2hCLE1BQTVCO0FBQ0EsYUFBT0EsTUFBUDtBQUNELEtBSkQ7O0FBTUEsUUFBSVUsVUFBVSxHQUFHLEtBQUtBLFVBQUwsQ0FBZ0JNLFFBQVEsQ0FBQ1osWUFBekIsQ0FBakI7QUFFQSxXQUFPO0FBQ0xhLE1BQUFBLFFBQVEsRUFBRUEsUUFETDtBQUVMakIsTUFBQUEsTUFBTSxFQUFFQSxNQUZIO0FBR0xVLE1BQUFBLFVBQVUsRUFBRUE7QUFIUCxLQUFQO0FBS0QsR0E1QmM7QUE2QmZTLEVBQUFBLFVBQVUsRUFBRSxTQUFTQSxVQUFULENBQW9CN0IsSUFBcEIsRUFBMEI7QUFDcEMsUUFBSThCLEtBQUssR0FBRzlCLElBQUksQ0FBQzhCLEtBQWpCO0FBQUEsUUFDSUMsV0FBVyxHQUFHL0IsSUFBSSxDQUFDRSxNQUR2QjtBQUFBLFFBRUlBLE1BQU0sR0FBRzZCLFdBQVcsS0FBS0MsU0FBaEIsR0FBNEIsRUFBNUIsR0FBaUNELFdBRjlDO0FBQUEsUUFHSTVCLFNBQVMsR0FBR0gsSUFBSSxDQUFDRyxTQUhyQjtBQUFBLFFBSUk4QixrQkFBa0IsR0FBR2pDLElBQUksQ0FBQ0ksYUFKOUI7QUFBQSxRQUtJQSxhQUFhLEdBQUc2QixrQkFBa0IsS0FBS0QsU0FBdkIsR0FBbUMsV0FBbkMsR0FBaURDLGtCQUxyRTtBQUFBLFFBTUlDLFNBQVMsR0FBR2xDLElBQUksQ0FBQ00sSUFOckI7QUFBQSxRQU9JQSxJQUFJLEdBQUc0QixTQUFTLEtBQUtGLFNBQWQsR0FBMEIsRUFBMUIsR0FBK0JFLFNBUDFDO0FBQUEsUUFRSUMsWUFBWSxHQUFHbkMsSUFBSSxDQUFDSyxPQVJ4QjtBQUFBLFFBU0lBLE9BQU8sR0FBRzhCLFlBQVksS0FBS0gsU0FBakIsR0FBNkIsRUFBN0IsR0FBa0NHLFlBVGhEO0FBV0EsUUFBSVgsR0FBRyxHQUFHLEtBQUtBLEdBQUwsQ0FBUztBQUNqQnZCLE1BQUFBLEVBQUUsRUFBRTZCLEtBRGE7QUFFakI1QixNQUFBQSxNQUFNLEVBQUVBLE1BRlM7QUFHakJDLE1BQUFBLFNBQVMsRUFBRUEsU0FBUyxJQUFJNkIsU0FIUDtBQUlqQjVCLE1BQUFBLGFBQWEsRUFBRUEsYUFKRTtBQUtqQkUsTUFBQUEsSUFBSSxFQUFFQSxJQUxXO0FBTWpCRCxNQUFBQSxPQUFPLEVBQUVBO0FBTlEsS0FBVCxDQUFWO0FBUUEsUUFBSUYsU0FBSixFQUFla0IsUUFBUSxDQUFDZSxJQUFULENBQWNDLFdBQWQsQ0FBMEJiLEdBQUcsQ0FBQ0osVUFBOUI7QUFDZkMsSUFBQUEsUUFBUSxDQUFDZSxJQUFULENBQWNFLFlBQWQsQ0FBMkJkLEdBQUcsQ0FBQ2QsTUFBSixFQUEzQixFQUF5Q1csUUFBUSxDQUFDZSxJQUFULENBQWNHLFVBQWQsQ0FBeUIsQ0FBekIsQ0FBekM7QUFDQWxCLElBQUFBLFFBQVEsQ0FBQ21CLElBQVQsQ0FBY0YsWUFBZCxDQUEyQmQsR0FBRyxDQUFDRyxRQUFKLEVBQTNCLEVBQTJDTixRQUFRLENBQUNtQixJQUFULENBQWNELFVBQWQsQ0FBeUIsQ0FBekIsQ0FBM0M7QUFDRCxHQXBEYztBQXFEZnBDLEVBQUFBLFNBQVMsRUFBRSxTQUFTQSxTQUFULENBQW1Cc0MsS0FBbkIsRUFBMEI7QUFDbkMsUUFBSTFCLFVBQVUsR0FBRzBCLEtBQUssQ0FBQ3RDLFNBQXZCO0FBQUEsUUFDSXVDLG1CQUFtQixHQUFHRCxLQUFLLENBQUNyQyxhQURoQztBQUFBLFFBRUlBLGFBQWEsR0FBR3NDLG1CQUFtQixLQUFLVixTQUF4QixHQUFvQyxXQUFwQyxHQUFrRFUsbUJBRnRFO0FBSUEsUUFBSUMsTUFBTSxDQUFDdkMsYUFBRCxDQUFWLEVBQTJCLE9BQU91QyxNQUFNLENBQUN2QyxhQUFELENBQU4sQ0FBc0J3QyxJQUF0QixDQUEyQjdCLFVBQTNCLENBQVA7O0FBQzNCLFFBQUlXLFFBQVEsR0FBR1IsVUFBVSxDQUFDckIsT0FBWCxDQUFtQk0sU0FBbkIsQ0FBNkJZLFVBQTdCLEVBQXlDWCxhQUF6QyxDQUFmOztBQUNBLFFBQUlnQixVQUFVLEdBQUcsS0FBS0EsVUFBTCxDQUFnQk0sUUFBaEIsQ0FBakI7QUFDQUwsSUFBQUEsUUFBUSxDQUFDZSxJQUFULENBQWNFLFlBQWQsQ0FBMkJsQixVQUEzQixFQUF1Q0MsUUFBUSxDQUFDZSxJQUFULENBQWNHLFVBQWQsQ0FBeUIsQ0FBekIsQ0FBdkM7QUFDRDtBQTlEYyxDQUFqQjtJQWlFQXZCLFlBQUEsR0FBaUJHLFVBQWpCOztBQ3ZFQSxJQUFJMEIsV0FBVyxHQUFHckQsWUFBbEI7O0FBRUEsSUFBSXNELFlBQVksR0FBR3BELHNCQUFzQixDQUFDbUQsV0FBRCxDQUF6Qzs7QUFFQSxTQUFTbkQsc0JBQVQsQ0FBZ0NDLEdBQWhDLEVBQXFDO0FBQUUsU0FBT0EsR0FBRyxJQUFJQSxHQUFHLENBQUNDLFVBQVgsR0FBd0JELEdBQXhCLEdBQThCO0FBQUVFLElBQUFBLE9BQU8sRUFBRUY7QUFBWCxHQUFyQztBQUF3RDs7SUFFL0ZxQixJQUFBLEdBQWlCOEIsWUFBWSxDQUFDakQsT0FBOUI7O0FDTEEsTUFBTWtELGFBQWEsR0FBS0MsS0FBRixJQUFhO0FBRWpDQyxFQUFBQSxTQUFTLENBQUMsTUFBTTtBQUVkLFFBQUksQ0FBQ0MsRUFBRSxDQUFDQyxZQUFSLEVBQXNCO0FBQUU7QUFFdEI7QUFDQSxVQUFJQyxlQUFlLEdBQUcsS0FBdEI7O0FBQ0EsV0FBSyxJQUFJQyxNQUFULElBQW1CTCxLQUFLLENBQUNNLGVBQXpCLEVBQTBDO0FBQ3hDLFlBQUlELE1BQU0sQ0FBQ0UsY0FBUCxDQUFzQkMsTUFBdEIsS0FBaUMsV0FBckMsRUFBa0Q7QUFDaERKLFVBQUFBLGVBQWUsR0FBRyxJQUFsQjtBQUNEO0FBQ0Y7O0FBRUQsVUFBSSxDQUFDQSxlQUFMLEVBQXNCO0FBRXBCLGNBQU1LLGdCQUFnQixHQUFHUCxFQUFFLENBQUNRLEVBQUgsQ0FBTUMsY0FBTixHQUF1QkMsWUFBaEQsQ0FGb0I7O0FBR3BCVixRQUFBQSxFQUFFLENBQUNRLEVBQUgsQ0FBTUMsY0FBTixHQUF1QkMsWUFBdkIsR0FBc0MsTUFBTTtBQUUxQztBQUNBLGNBQUlaLEtBQUssQ0FBQ2EsZUFBTixLQUEwQixLQUE5QixFQUFxQztBQUNuQyxrQkFBTUMsd0JBQXdCLEdBQUc7QUFDL0JoQyxjQUFBQSxLQUFLLEVBQUVrQixLQUFLLENBQUNlO0FBRGtCLGFBQWpDO0FBSUE1QyxZQUFBQSxJQUFVLENBQUNVLFVBQVgsQ0FBc0JpQyx3QkFBdEI7QUFDRCxXQU5ELE1BUUs7QUFDSCxnQkFBSUUsa0JBQWtCLEdBQUcsVUFBU2hCLEtBQVQsRUFBZ0I7QUFDdkMsa0JBQUk3QyxTQUFTLEdBQUcsZUFBZTZDLEtBQUssQ0FBQ2lCLGlCQUFyQixHQUF5QyxJQUF6RCxDQUR1Qzs7QUFHdkMsa0JBQUlqQixLQUFLLENBQUNrQixhQUFWLEVBQXlCO0FBQUU7QUFDekIvRCxnQkFBQUEsU0FBUyxJQUFJLGtCQUFrQitDLEVBQUUsQ0FBQ1EsRUFBSCxDQUFNQyxjQUFOLEdBQXVCUSxLQUF6QyxHQUFpRCxJQUE5RDtBQUNEOztBQUVELGtCQUFJbkIsS0FBSyxDQUFDb0Isa0JBQVYsRUFBOEI7QUFBRTtBQUM5QixvQkFBSUMsVUFBVSxHQUFHbkIsRUFBRSxDQUFDUSxFQUFILENBQU1DLGNBQU4sR0FBdUJXLElBQXhDOztBQUNBLG9CQUFJQyxjQUFjLEdBQUksVUFBU0YsVUFBVCxFQUFxQjtBQUN6QyxzQkFBSUcsYUFBYSxHQUFHLFdBQXBCO0FBQ0Esc0JBQUlGLElBQUksR0FBR0QsVUFBVSxDQUFDSSxNQUFYLENBQWtCLENBQWxCLEVBQXFCSixVQUFVLENBQUNLLE1BQVgsR0FBb0JGLGFBQWEsQ0FBQ0UsTUFBdkQsQ0FBWDtBQUNBLHlCQUFPSixJQUFQO0FBQ0QsaUJBSnFCLENBSXBCRCxVQUpvQixDQUF0Qjs7QUFLQWxFLGdCQUFBQSxTQUFTLElBQUksd0JBQXdCb0UsY0FBeEIsR0FBeUMsSUFBdEQ7QUFDRDs7QUFFRCxrQkFBSXZCLEtBQUssQ0FBQzJCLFdBQVYsRUFBdUI7QUFBRTtBQUN2QixvQkFBSXpCLEVBQUUsQ0FBQ1EsRUFBSCxDQUFNQyxjQUFOLEdBQXVCaUIsR0FBdkIsS0FBK0IsSUFBbkMsRUFBeUM7QUFDdkMsc0JBQUlDLE9BQU8sR0FBR2xDLE1BQU0sQ0FBQ21DLFFBQVAsQ0FBZ0JDLE1BQWhCLEdBQXlCN0IsRUFBRSxDQUFDUSxFQUFILENBQU1DLGNBQU4sR0FBdUJpQixHQUE5RDtBQUNELGlCQUZELE1BSUs7QUFDSCxzQkFBSUMsT0FBTyxHQUFHbEMsTUFBTSxDQUFDbUMsUUFBUCxDQUFnQkMsTUFBOUI7QUFDRDs7QUFFRCxvQkFBSUMsVUFBVSxHQUFJLFVBQVNDLE9BQVQsRUFBa0I7QUFDbEMsc0JBQUlDLGFBQWEsR0FBR0QsT0FBTyxDQUFDRSxXQUFSLENBQW9CLEdBQXBCLENBQXBCO0FBQ0Esc0JBQUlDLFNBQVMsR0FBR0gsT0FBTyxDQUFDSSxTQUFSLENBQWtCSCxhQUFhLEdBQUcsQ0FBbEMsRUFBb0NELE9BQU8sQ0FBQ1AsTUFBNUMsQ0FBaEI7O0FBQ0Esc0JBQUlZLEtBQUssQ0FBQ0YsU0FBRCxDQUFULEVBQXNCO0FBQ3BCLDJCQUFPSCxPQUFQLENBRG9CO0FBRXJCLG1CQUZELE1BR0s7QUFDSCwyQkFBT00sUUFBUSxDQUFDZCxNQUFULENBQWdCLENBQWhCLEVBQWtCUyxhQUFsQixDQUFQLENBREc7QUFFSjtBQUNGLGlCQVRpQixDQVNoQkwsT0FUZ0IsQ0FBbEI7O0FBVUExRSxnQkFBQUEsU0FBUyxJQUFJLGlCQUFpQjZFLFVBQWpCLEdBQThCLElBQTNDO0FBQ0Q7O0FBRUQsa0JBQUloQyxLQUFLLENBQUN3QyxhQUFWLEVBQXlCO0FBQUU7QUFDekJyRixnQkFBQUEsU0FBUyxJQUFJLG1CQUFtQitDLEVBQUUsQ0FBQ3VDLE9BQUgsQ0FBV0Msa0JBQVgsRUFBbkIsR0FBcUQsSUFBbEU7QUFDRDs7QUFFRCxrQkFBSTFDLEtBQUssQ0FBQzJDLG1CQUFWLEVBQStCO0FBQUU7QUFDL0Isb0JBQUlDLGdCQUFnQixHQUFFLEVBQXRCOztBQUVBLHFCQUFLLElBQUlDLElBQVQsSUFBaUI3QyxLQUFLLENBQUNNLGVBQXZCLEVBQXdDO0FBQ3RDLHVCQUFLLElBQUlELE1BQVQsSUFBbUJ3QyxJQUFJLENBQUN0QyxjQUFMLENBQW9CdUMsS0FBdkMsRUFBOEM7QUFBRTtBQUM5Q0Ysb0JBQUFBLGdCQUFnQixJQUFJQyxJQUFJLENBQUNFLFNBQUwsQ0FBZUMsR0FBZixDQUFtQjNDLE1BQW5CLEVBQTJCbEUsS0FBM0IsR0FBbUMsSUFBdkQ7QUFDRDs7QUFFRHlHLGtCQUFBQSxnQkFBZ0IsR0FBR0EsZ0JBQWdCLENBQUNLLE9BQWpCLENBQXlCLE9BQXpCLEVBQWtDLEVBQWxDLENBQW5CO0FBQ0E5RixrQkFBQUEsU0FBUyxJQUFJLE1BQU0wRixJQUFJLENBQUNLLFFBQVgsR0FBc0IsS0FBdEIsR0FBOEJOLGdCQUE5QixHQUFpRCxJQUE5RDtBQUNBQSxrQkFBQUEsZ0JBQWdCLEdBQUcsRUFBbkI7QUFDRDtBQUNGOztBQUVEekYsY0FBQUEsU0FBUyxHQUFHQSxTQUFTLENBQUM4RixPQUFWLENBQWtCLE9BQWxCLEVBQTJCLEVBQTNCLENBQVosQ0F6RHVDOztBQTBEdkM5RixjQUFBQSxTQUFTLElBQUksR0FBYjtBQUNBLHFCQUFPUSxJQUFJLENBQUN3RixLQUFMLENBQVdoRyxTQUFYLENBQVA7QUFDRCxhQTVERDs7QUE4REEsZ0JBQUlBLFNBQVMsR0FBRzZELGtCQUFrQixDQUFDaEIsS0FBRCxDQUFsQztBQUVBLGtCQUFNb0QsY0FBYyxHQUFHO0FBQ3JCdEUsY0FBQUEsS0FBSyxFQUFFa0IsS0FBSyxDQUFDZSxhQURRO0FBRXJCNUQsY0FBQUE7QUFGcUIsYUFBdkI7QUFLQWdCLFlBQUFBLElBQVUsQ0FBQ1UsVUFBWCxDQUFzQnVFLGNBQXRCO0FBQ0Q7O0FBRURsRCxVQUFBQSxFQUFFLENBQUNDLFlBQUgsR0FBa0IsSUFBbEIsQ0FwRjBDO0FBc0YxQzs7QUFDQU0sVUFBQUEsZ0JBQWdCO0FBR2hCLGlCQUFPLE1BQU07QUFFWixXQUZEO0FBR0QsU0E3RkQ7QUE4RkQ7QUFDRjtBQUNGLEdBL0dRLENBQVQsQ0FGaUM7O0FBbUhqQyxTQUFPLElBQVA7QUFDRCxDQXBIRDs7QUNBTyxTQUFTNEMsZ0JBQVQsQ0FBMEI7QUFBRXRDLEVBQUFBLGFBQUY7QUFBaUJGLEVBQUFBLGVBQWpCO0FBQWtDSSxFQUFBQSxpQkFBbEM7QUFBcURDLEVBQUFBLGFBQXJEO0FBQW9FRSxFQUFBQSxrQkFBcEU7QUFBd0ZPLEVBQUFBLFdBQXhGO0FBQXFHYSxFQUFBQSxhQUFyRztBQUFvSEcsRUFBQUEsbUJBQXBIO0FBQXlJckMsRUFBQUE7QUFBekksQ0FBMUIsRUFBc0w7QUFDekwsU0FBTyxjQUFDLGFBQUQ7QUFBZSxJQUFBLGFBQWEsRUFBRVMsYUFBOUI7QUFBNkMsSUFBQSxlQUFlLEVBQUVGLGVBQTlEO0FBQStFLElBQUEsaUJBQWlCLEVBQUVJLGlCQUFsRztBQUFxSCxJQUFBLGFBQWEsRUFBRUMsYUFBcEk7QUFBbUosSUFBQSxrQkFBa0IsRUFBRUUsa0JBQXZLO0FBQTJMLElBQUEsV0FBVyxFQUFFTyxXQUF4TTtBQUFxTixJQUFBLGFBQWEsRUFBRWEsYUFBcE87QUFBbVAsSUFBQSxtQkFBbUIsRUFBRUcsbUJBQXhRO0FBQTZSLElBQUEsZUFBZSxFQUFFckM7QUFBOVMsSUFBUDtBQUNIOzs7OyJ9
